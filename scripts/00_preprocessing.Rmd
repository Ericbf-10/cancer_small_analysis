---
title: "Small analysis for Tiwari V. et al."
subtitle: <center> Data preprocessing </center>
author: "Eric Bautista Farrerons"
date: '`r paste("First created on November 2024. Updated on ", format(Sys.Date(), "%d %B %Y"))`'
output:
  html_document:
    css: style.css
    code_folding: hide
    fig_caption: yes
    toc: yes
    toc_float:
      collapsed: true
      smooth_scroll: true
    toc_depth: 4
    number_sections: true
---

```{r gunzip, message=FALSE, warning=FALSE}
# Load packages and paths
library(here)
source(here::here("scripts", "install.R"))
source(here::here("scripts", "paths.R"))

# Gunzip all files in the raw data folder and place them in the data folder
gunzip_files <- function(raw_path, data_path) {
  if (!dir.exists(raw_path)) {
    stop("Raw path does not exist: ", raw_path)
  }
  if (!dir.exists(data_path)) {
    dir.create(data_path, recursive = TRUE)
  }
  
  # List all .gz files in the raw data folder
  gz_files <- list.files(raw_path, pattern = "\\.gz$", full.names = TRUE)
  
  if (length(gz_files) == 0) {
    cat("No .gz files found in", raw_path, "\n")
    return(NULL)
  }
  
  # Iterate over the files and gunzip them to the data folder
  lapply(gz_files, function(file) {
    # Determine the destination file path
    dest_file <- file.path(data_path, gsub("\\.gz$", "", basename(file)))
    cat("Unzipping:", file, "to", dest_file, "\n")
    # Decompress the file without removing the original
    R.utils::gunzip(file, destname = dest_file, overwrite = TRUE, remove = FALSE)
  })
}

gunzip_files(raw_path, data_path)
```